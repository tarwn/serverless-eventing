<!DOCTYPE html>
<html>
<head>
    <title>Hello index.html</title>
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <h1>Client #1</h1>
    <div id="machines">
        <div class="machine" data-machineId="machine-01" data-clientId="client-01">1-1</div>
        <div class="machine" data-machineId="machine-02" data-clientId="client-01">1-2</div>
        <div class="machine" data-machineId="machine-03" data-clientId="client-01">1-3</div>
        <div class="machine" data-machineId="machine-04" data-clientId="client-01">1-4</div>
        <div class="machine" data-machineId="machine-05" data-clientId="client-01">1-5</div>
    </div>
    <h1>Client #2</h1>
    <div id="machines">
        <div class="machine" data-machineId="machine-01" data-clientId="client-01">1-1</div>
        <div class="machine" data-machineId="machine-02" data-clientId="client-01">1-2</div>
        <div class="machine" data-machineId="machine-03" data-clientId="client-01">1-3</div>
        <div class="machine" data-machineId="machine-04" data-clientId="client-01">1-4</div>
        <div class="machine" data-machineId="machine-05" data-clientId="client-01">1-5</div>
    </div>
    <h1>Behind the scenes</h1>
    <div id="buttons"></div>
    <div id="log"></div>

    <script>
        var logId = 0;
        function log(message, parentId){
            var localId = (parentId != null ? parentId : ++logId);
            $("#log").prepend("<div>" + localId + ": " + new Date().toISOString() + " - " + message + "</div>");
            return localId;
        }

        $().ready(function(){
            $("#buttons").append("<input type='button' id='btnTestEvent' value='Fire Test Event' />");
            $("#btnTestEvent").on("click", function(){
                var data = JSON.stringify({ "eventType": "test-event", "client-side-time": new Date() });
                var logId = log("Sending: " + data);
                $.ajax({
                    type: "POST",
                    url: "event-api/events",
                    contentType: "application/json; charset=utf-8",
                    data: data,
                    success: function(data){
                        log("Success: " + data, logId);
                    },
                    error: function(jqXHR, status, error){
                        log("Error: " + jqXHR.status + " " + status, logId);
                    }
                });
            });

        });

        $().ready(function(){
            var data = { clients: [] };
            data.clients.push({ clientId: "client-01", machines: [], rules: [] });
            data.clients.push({ clientId: "client-02", machines: [], rules: [] });

            data.clients.forEach(function(c){
               // c.machines = 
            });
        });
    </script>
</body>
</html>